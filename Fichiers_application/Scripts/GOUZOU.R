



library(ggplot2)
library(dplyr)


# # GOUZOU MAKER
# library(sf)
# setwd('D:/apis_/download')
# gouzou.shp <- read_sf('gouzou_brezel.shp')
# #
# tab_gouzou <- st_coordinates(gouzou.shp) %>%
#   as_tibble() %>%
#   mutate(X = (X-min(X)),
#          X = X/max(X),
#          Y = (Y-min(Y)),
#          Y = Y/max(Y),
#          X=round(X, 2),
#          Y=round(Y,2))%>%
#   select(id=L2, X, Y)
# 
# sf_use_s2(FALSE)
# centroid <- st_centroid(gouzou.shp) %>%
#   st_coordinates() %>%
#   as.data.frame()
# centroid$id <- 1:nrow(centroid)
# 
# ggplot(tab_gouzou) +
#   geom_polygon(aes(X, Y, group = id), fill="wheat3", colour = "black", linewidth = 0.1) +
#   geom_text(data = centroid, aes(X,Y,label = id))+
#   theme_void()
# 
# 
# 
# 
# # brezel
# # tab_gouzou$couleur <- c('wheat2', 'goldenrod', 'wheat2',rep('snow',4), 'grey24','darkgoldenrod', 'darkgoldenrod', 'grey24', 'wheat4', 'goldenrod', #<-13
# #                         'wheat4', 'wheat4', 'wheat4', 'firebrick1', 'firebrick1', 'darkgoldenrod', 'darkgoldenrod', 'darkgoldenrod', rep('snow',4), 'darkgoldenrod', rep('snow',3)   )[tab_gouzou$id]
# 
# 
# ggplot_object <- ggplot()
# for(col in unique(tab_gouzou$couleur))
#   ggplot_object <- ggplot_object +
#   geom_polygon(data = filter(tab_gouzou, couleur == col), 
#                aes(X, Y, group = id), 
#                colour = "black", 
#                fill = col,
#                linewidth = 3)
# 
# ggplot_object + theme_void()
# 
# dput(tab_gouzou)




# si besoin de sortir les coorodonnées d'un gouzou. Sinon elle est appelé dans geom_gouzou.

GOUZOU_tab <- function(X0, Y0, LX, LY, type = 'basique'){
  
  all_gouzou <- list( 
    basique = structure(list(X=c(0.33,0.11,0,0.17,0.29,0.4,0.53,0.63,0.67,0.69,0.67,0.64,0.58,0.65,0.82,0.78,1,0.82,0.64,0.63,0.73,0.78,0.81,0.83,0.8,0.76,0.72,0.67,0.62,0.55,0.5,0.45,0.42,0.46,0.52,0.59,0.61,0.62,0.63,0.48,0.3,0.33,0.49,0.55,0.59,0.64,0.68,0.68,0.64,0.59,0.53,0.46,0.39,0.34,0.27,0.21,0.18,0.14,0.1,0.08,0.09,0.1,0.13,0.19,0.27,0.38,0.49),
                             Y=c(0.39,0.25,0.35,0.61,0.53,0.5,0.51,0.56,0.62,0.7,0.77,0.84,0.91,1,0.93,0.63,0.31,0,0,0.17,0.2,0.23,0.25,0.29,0.25,0.22,0.21,0.19,0.19,0.2,0.2,0.23,0.25,0.22,0.19,0.18,0.18,0.18,0,0,0.19,0.39,0.96,0.92,0.88,0.81,0.73,0.66,0.6,0.54,0.52,0.51,0.51,0.52,0.55,0.59,0.61,0.63,0.73,0.78,0.85,0.88,0.92,0.95,0.98,0.99,0.96),
                             id=c(1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2),
                             couleur=as.factor("wheat2")),
                        row.names=c(NA,-67L),class=c("tbl_df","tbl","data.frame")),
    
    fleur = structure(list(X=c(0.74,0.79,0.83,0.86,0.87,0.84,0.8,0.75,0.72,0.69,0.65,0.61,0.6,0.62,0.66,0.7,0.73,0.73,0.74,0.53,0.6,0.66,0.71,0.77,0.82,0.86,0.88,0.89,0.89,0.88,0.85,0.8,0.73,0.64,0.56,0.5,0.46,0.45,0.47,0.53,0.82,1,0.95,0.74,0.82,0.84,0.75,0.64,0.59,0.65,0.7,0.73,0.64,0.59,0.53,0.49,0.47,0.52,0.58,0.64,0.55,0.47,0.43,0.49,0.47,0.23,0.26,0.47,0.51,0.55,0.63,0.73,0.78,0.82,0.27,0.26,0.29,0.32,0.35,0.35,0.33,0.3,0.26,0.25,0.23,0.25,0.27,0.31,0.25,0.24,0.21,0.22,0.21,0.17,0.16,0.19,0.22,0.26,0.3,0.31,0.16,0.13,0.1,0.12,0.09,0.08,0.05,0.04,0.05,0.06,0.08,0.12,0.16,0.18,0.16,0.16,0.09,0.08,0.06,0.04,0.07,0.08,0.09,0.06,0.04,0.02,0,0,0.01,0.04,0.07,0.09,0.12,0.1,0.11,0.12,0.14,0.14,0.16,0.15,0.12,0.1,0.06,0.05,0.05,0.08,0.1,0.12,0.2,0.18,0.2,0.23,0.24,0.25,0.26,0.25,0.22,0.19,0.16,0.14,0.15,0.16,0.18,0.2,0.24,0.25,0.23,0.2,0.17,0.13,0.1,0.1,0.09,0.11,0.14,0.18,0.22,0.24,0.24,0.23,0.23,0.26,0.27,0.26,0.25,0.23,0.22,0.21,0.24,0.24,0.22,0.2,0.2,0.24,0.21,0.21,0.22,0.17,0.21,0.23,0.23,0.16,0.13,0.1,0.09,0.13,0.2,0.21),
                           Y=c(0.97,0.98,0.98,0.97,0.94,0.9,0.87,0.86,0.85,0.88,0.9,0.93,0.97,0.99,1,1,0.98,0.98,0.97,0.7,0.73,0.74,0.74,0.72,0.69,0.66,0.63,0.58,0.53,0.49,0.44,0.39,0.36,0.35,0.38,0.43,0.5,0.58,0.66,0.7,0.41,0.21,0.16,0.26,0.21,0.15,0,0,0.13,0.14,0.16,0.18,0.14,0.14,0.16,0.18,0.2,0.15,0.14,0,0,0.11,0.19,0.35,0.34,0.42,0.48,0.47,0.42,0.38,0.35,0.35,0.38,0.41,0.58,0.59,0.6,0.6,0.59,0.57,0.55,0.53,0.53,0.54,0.57,0.58,0.58,0.61,0.59,0.6,0.6,0.62,0.6,0.6,0.61,0.63,0.65,0.65,0.64,0.61,0.6,0.58,0.6,0.58,0.56,0.56,0.56,0.58,0.59,0.61,0.63,0.63,0.64,0.63,0.61,0.6,0.55,0.54,0.53,0.52,0.54,0.53,0.51,0.49,0.49,0.5,0.5,0.52,0.53,0.55,0.56,0.55,0.52,0.49,0.5,0.51,0.52,0.49,0.47,0.45,0.44,0.44,0.44,0.46,0.47,0.49,0.51,0.52,0.53,0.55,0.56,0.57,0.56,0.54,0.51,0.49,0.47,0.47,0.47,0.49,0.52,0.53,0.54,0.53,0.59,0.58,0.57,0.56,0.53,0.52,0.51,0.52,0.54,0.56,0.59,0.6,0.6,0.59,0.47,0.43,0.39,0.36,0.33,0.29,0.27,0.25,0.26,0.27,0.3,0.33,0.37,0.42,0.46,0.47,0.36,0.36,0.34,0.35,0.34,0.33,0.32,0.33,0.34,0.36,0.37,0.37,0.37,0.36),
                           id=c(1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,10,10,10,10,10,10,10,10,10,10,10,10,10,10,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,12,12,12,12,12,12,12,12,12,12,12,12,12,12),
                           couleur=as.factor(c(rep('tomato2', 19), rep('wheat2', 55), rep('dodgerblue2', 90), rep('gold1', 14), rep('chartreuse4', 30)))),
                      row.names=c(NA,-208L),class=c("tbl_df","tbl","data.frame")),
    
    nuage = structure(list(id=c(1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5),
                           X=c(0.45,0.49,0.54,0.63,0.69,0.76,0.78,0.84,0.91,0.97,1,1,0.95,0.87,0.79,0.7,0.62,0.52,0.47,0.41,0.35,0.29,0.22,0.16,0.09,0.04,0.01,0,0.01,0.08,0.15,0.19,0.23,0.29,0.38,0.41,0.45,0.31,0.36,0.4,0.41,0.4,0.37,0.31,0.5,0.5,0.49,0.5,0.49,0.55,0.54,0.46,0.49,0.49,0.51,0.5,0.48,0.44,0.39,0.35,0.32,0.33,0.32,0.29,0.32,0.33,0.35,0.38,0.4,0.41,0.39,0.38,0.35,0.32,0.31,0.31,0.31,0.32,0.34,0.35,0.38,0.38,0.48,0.49,0.48,0.38,0.37,0.34,0.31,0.28,0.26,0.26,0.25,0.26,0.29,0.31,0.34,0.38,0.43,0.45,0.47,0.48),
                           Y=c(0.99,1,0.99,0.97,0.93,0.9,0.92,0.91,0.88,0.85,0.79,0.74,0.7,0.68,0.69,0.72,0.69,0.68,0.68,0.68,0.71,0.73,0.72,0.73,0.75,0.78,0.82,0.88,0.9,0.93,0.95,0.92,0.92,0.96,0.99,1,0.99,0.83,0.82,0.82,0.84,0.82,0.81,0.83,0.67,0.46,0.67,0.67,0.45,0.43,0.37,0.26,0.29,0.26,0.19,0.13,0.09,0.06,0.01,0,0.02,0.12,0.02,0.02,0.13,0.13,0.12,0.12,0.13,0.15,0.13,0.12,0.12,0.14,0.17,0.19,0.23,0.26,0.29,0.3,0.3,0.29,0.45,0.45,0.45,0.3,0.3,0.3,0.31,0.33,0.36,0.38,0.41,0.44,0.46,0.48,0.49,0.5,0.49,0.48,0.47,0.45),
                           couleur=as.factor(c(rep('lightskyblue',37),rep('wheat2',65)))),
                      row.names=c(NA,-102L),class=c("tbl_df","tbl","data.frame")),
    brezel = structure(list(id=c(1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,9,9,9,9,9,9,10,10,10,10,11,11,11,11,11,11,11,11,11,11,11,12,12,12,12,12,12,12,12,12,12,12,13,13,13,13,13,13,13,13,14,14,14,14,14,14,14,14,14,14,14,15,15,15,15,15,15,15,15,15,15,16,16,16,16,16,16,17,17,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,23,23,23,23,23,24,24,24,24,24,25,25,25,25,25,26,26,26,26,26,26,27,27,27,27,27,28,28,28,28,28,29,29,29,29,29),
                          X=c(0.84,0.82,0.77,0.73,0.66,0.62,0.6,0.53,0.47,0.45,0.45,0.48,0.55,0.63,0.7,0.74,0.79,0.84,0.84,0.85,0.91,0.96,0.99,1,0.98,0.91,0.8,0.73,0.61,0.5,0.39,0.33,0.26,0.23,0.22,0.22,0.15,0.08,0.03,0,0,0.02,0.06,0.11,0.17,0.25,0.33,0.4,0.46,0.49,0.46,0.45,0.45,0.24,0.22,0.22,0.22,0.2,0.18,0.19,0.2,0.21,0.14,0.12,0.14,0.17,0.18,0.23,0.28,0.3,0.31,0.35,0.32,0.27,0.3,0.33,0.35,0.42,0.47,0.48,0.52,0.55,0.59,0.63,0.68,0.71,0.73,0.74,0.72,0.77,0.78,0.77,0.73,0.69,0.68,0.74,0.78,0.82,0.85,0.32,0.45,0.47,0.5,0.6,0.68,0.72,0.7,0.67,0.66,0.65,0.64,0.62,0.61,0.59,0.58,0.57,0.55,0.56,0.49,0.47,0.41,0.4,0.37,0.36,0.37,0.35,0.31,0.32,0.33,0.36,0.41,0.39,0.34,0.3,0.28,0.29,0.23,0.22,0.2,0.18,0.18,0.17,0.15,0.26,0.27,0.27,0.28,0.31,0.39,0.35,0.3,0.3,0.31,0.32,0.3,0.32,0.31,0.3,0.32,0.31,0.3,0.3,0.28,0.25,0.23,0.22,0.22,0.22,0.22,0.25,0.31,0.15,0.18,0.18,0.2,0.22,0.23,0.19,0.17,0.14,0.12,0.15,0.31,0.35,0.37,0.36,0.37,0.4,0.4,0.35,0.33,0.3,0.27,0.31,0.31,0.31,0.58,0.59,0.61,0.62,0.64,0.65,0.66,0.67,0.7,0.72,0.71,0.69,0.66,0.62,0.6,0.58,0.57,0.58,0.47,0.5,0.58,0.59,0.62,0.66,0.69,0.71,0.72,0.74,0.71,0.63,0.55,0.49,0.47,0.72,0.76,0.77,0.78,0.77,0.72,0.56,0.58,0.51,0.56,0.22,0.24,0.26,0.31,0.28,0.26,0.22,0.2,0.19,0.2,0.22,0.62,0.66,0.73,0.77,0.82,0.84,0.84,0.8,0.75,0.7,0.62,0.77,0.76,0.72,0.72,0.69,0.73,0.77,0.77,0.56,0.56,0.5,0.45,0.42,0.4,0.4,0.41,0.48,0.49,0.56,0.32,0.36,0.38,0.41,0.42,0.42,0.41,0.39,0.34,0.32,0.28,0.29,0.23,0.22,0.25,0.28,0.39,0.4,0.41,0.4,0.4,0.38,0.37,0.37,0.39,0.46,0.47,0.48,0.48,0.48,0.47,0.46,0.45,0.46,0.24,0.32,0.39,0.52,0.67,0.79,0.9,0.96,0.99,0.99,0.97,0.91,0.8,0.73,0.62,0.5,0.39,0.26,0.24,0.22,0.22,0.15,0.08,0.05,0.17,0.22,0.81,0.84,0.85,0.87,0.91,0.9,0.88,0.84,0.83,0.8,0.81,0.85,0.86,0.86,0.85,0.85,0.87,0.89,0.89,0.87,0.87,0.93,0.94,0.95,0.94,0.93,0.83,0.85,0.85,0.83,0.83,0.35,0.4,0.45,0.43,0.4,0.35,0.33,0.35,0.35,0.34,0.33,0.27,0.28,0.29,0.28,0.27,0.4,0.41,0.43,0.41,0.4),
                          Y=c(0.82,0.78,0.69,0.65,0.61,0.59,0.59,0.63,0.68,0.76,0.85,0.93,0.98,1,0.99,0.97,0.93,0.85,0.82,0.77,0.72,0.64,0.55,0.43,0.25,0.13,0.05,0.01,0,0.02,0.07,0.13,0.2,0.3,0.36,0.29,0.29,0.34,0.39,0.49,0.57,0.67,0.75,0.81,0.86,0.9,0.92,0.93,0.94,0.94,0.87,0.8,0.75,0.75,0.72,0.68,0.66,0.64,0.59,0.56,0.53,0.51,0.47,0.41,0.38,0.35,0.34,0.38,0.42,0.43,0.42,0.39,0.34,0.27,0.23,0.21,0.21,0.26,0.28,0.26,0.23,0.21,0.21,0.2,0.23,0.26,0.31,0.35,0.41,0.43,0.48,0.52,0.55,0.55,0.58,0.59,0.64,0.67,0.77,0.74,0.75,0.68,0.64,0.59,0.59,0.41,0.4,0.41,0.41,0.4,0.41,0.39,0.39,0.4,0.4,0.38,0.49,0.41,0.34,0.33,0.28,0.27,0.27,0.27,0.3,0.31,0.3,0.32,0.35,0.39,0.39,0.39,0.41,0.43,0.46,0.44,0.38,0.4,0.41,0.42,0.44,0.45,0.47,0.54,0.53,0.56,0.59,0.62,0.62,0.62,0.62,0.64,0.66,0.68,0.72,0.74,0.74,0.71,0.68,0.66,0.64,0.62,0.62,0.63,0.64,0.65,0.67,0.69,0.72,0.74,0.74,0.47,0.44,0.42,0.41,0.4,0.38,0.35,0.35,0.39,0.41,0.47,0.3,0.31,0.3,0.27,0.27,0.27,0.24,0.21,0.21,0.23,0.28,0.32,0.3,0.3,0.4,0.4,0.39,0.39,0.41,0.4,0.41,0.41,0.4,0.41,0.36,0.34,0.32,0.31,0.32,0.35,0.38,0.4,0.29,0.32,0.34,0.32,0.31,0.31,0.32,0.36,0.4,0.35,0.26,0.21,0.21,0.26,0.29,0.41,0.46,0.51,0.48,0.43,0.41,0.4,0.35,0.33,0.4,0.65,0.63,0.62,0.62,0.59,0.54,0.51,0.54,0.59,0.64,0.65,0.59,0.61,0.65,0.69,0.78,0.82,0.76,0.66,0.61,0.59,0.59,0.51,0.46,0.41,0.41,0.55,0.55,0.52,0.51,0.41,0.4,0.32,0.27,0.26,0.24,0.27,0.28,0.33,0.34,0.41,0.42,0.42,0.41,0.41,0.41,0.4,0.39,0.39,0.41,0.42,0.46,0.44,0.38,0.4,0.42,0.46,0.51,0.51,0.5,0.49,0.48,0.48,0.49,0.5,0.51,0.58,0.58,0.58,0.57,0.56,0.56,0.56,0.57,0.58,0.25,0.18,0.12,0.07,0.08,0.12,0.2,0.3,0.38,0.38,0.25,0.12,0.05,0.01,0,0.02,0.07,0.2,0.25,0.33,0.29,0.29,0.34,0.37,0.33,0.33,0.66,0.62,0.58,0.53,0.46,0.44,0.49,0.56,0.61,0.63,0.66,0.7,0.69,0.68,0.68,0.7,0.63,0.63,0.62,0.61,0.63,0.52,0.53,0.51,0.51,0.52,0.48,0.48,0.46,0.46,0.48,0.86,0.87,0.87,0.86,0.87,0.86,0.89,0.9,0.89,0.88,0.89,0.84,0.86,0.84,0.83,0.84,0.77,0.79,0.77,0.76,0.77),
                          couleur=c("wheat2",
                                    "wheat2","wheat2","wheat2","wheat2","wheat2","wheat2","wheat2","wheat2","wheat2","wheat2","wheat2","wheat2","wheat2","wheat2","wheat2","wheat2","wheat2","wheat2","goldenrod","goldenrod","goldenrod","goldenrod","goldenrod","goldenrod","goldenrod","goldenrod","goldenrod","goldenrod","goldenrod","goldenrod","goldenrod","goldenrod","goldenrod","goldenrod","goldenrod","goldenrod","goldenrod","goldenrod","goldenrod","goldenrod","goldenrod","goldenrod","goldenrod","goldenrod","goldenrod","goldenrod","goldenrod","goldenrod","goldenrod","goldenrod","goldenrod","goldenrod","goldenrod","goldenrod","goldenrod","goldenrod","goldenrod","goldenrod","goldenrod","goldenrod","goldenrod","goldenrod","goldenrod","goldenrod","goldenrod","goldenrod","goldenrod","goldenrod","goldenrod","goldenrod","goldenrod","goldenrod","goldenrod","goldenrod","goldenrod","goldenrod","goldenrod","goldenrod","goldenrod","goldenrod",
                                    "goldenrod","goldenrod","goldenrod","goldenrod","goldenrod","goldenrod","goldenrod","goldenrod","goldenrod","goldenrod","goldenrod","goldenrod","goldenrod","goldenrod","goldenrod","goldenrod","goldenrod","goldenrod","wheat2","wheat2","wheat2","wheat2","wheat2","wheat2","wheat2","wheat2","wheat2","wheat2","wheat2","wheat2","wheat2","wheat2","wheat2","wheat2","wheat2","wheat2","wheat2","wheat2","wheat2","wheat2","wheat2","wheat2","wheat2","wheat2","wheat2","wheat2","wheat2","wheat2","wheat2","wheat2","wheat2","wheat2","wheat2","wheat2","wheat2","wheat2","wheat2","wheat2","wheat2","wheat2","wheat2","wheat2","wheat2","wheat2","wheat2","wheat2","wheat2","wheat2","wheat2","wheat2","wheat2","wheat2","wheat2","wheat2","wheat2","snow","snow","snow","snow","snow","snow","snow","snow","snow","snow","snow","snow","snow","snow","snow","snow","snow","snow","snow","snow","snow","snow","snow","snow","snow","snow","snow","snow","snow","snow","snow","snow","snow","snow","snow","snow","snow","snow","snow","snow","snow","snow","snow","snow","snow","snow","snow","snow","snow","snow","snow","snow","snow","snow","snow","snow","snow","snow","grey24","grey24","grey24","grey24","grey24","grey24","grey24",
                                    "grey24","grey24","grey24","grey24","grey24","grey24","grey24","grey24","darkgoldenrod","darkgoldenrod","darkgoldenrod","darkgoldenrod","darkgoldenrod","darkgoldenrod","darkgoldenrod","darkgoldenrod","darkgoldenrod","darkgoldenrod","grey24","grey24","grey24","grey24","grey24","grey24","grey24","grey24","grey24","grey24","grey24","wheat4","wheat4","wheat4","wheat4","wheat4","wheat4","wheat4","wheat4","wheat4","wheat4","wheat4","goldenrod","goldenrod","goldenrod","goldenrod","goldenrod","goldenrod","goldenrod","goldenrod","wheat4","wheat4","wheat4","wheat4","wheat4","wheat4","wheat4","wheat4","wheat4","wheat4","wheat4","wheat4","wheat4","wheat4","wheat4","wheat4","wheat4","wheat4","wheat4","wheat4","wheat4","wheat4","wheat4","wheat4","wheat4","wheat4","wheat4","firebrick1","firebrick1","firebrick1","firebrick1","firebrick1","firebrick1","firebrick1","firebrick1","firebrick1","firebrick1","firebrick1","firebrick1","firebrick1","firebrick1","firebrick1","firebrick1","firebrick1","firebrick1",
                                    "darkgoldenrod","darkgoldenrod","darkgoldenrod","darkgoldenrod","darkgoldenrod","darkgoldenrod","darkgoldenrod","darkgoldenrod","darkgoldenrod","darkgoldenrod","darkgoldenrod","darkgoldenrod","darkgoldenrod","darkgoldenrod","darkgoldenrod","darkgoldenrod","darkgoldenrod","darkgoldenrod","darkgoldenrod","darkgoldenrod","darkgoldenrod","darkgoldenrod","darkgoldenrod","darkgoldenrod","darkgoldenrod","darkgoldenrod","darkgoldenrod","darkgoldenrod","darkgoldenrod","darkgoldenrod","darkgoldenrod","darkgoldenrod","darkgoldenrod","darkgoldenrod","darkgoldenrod","darkgoldenrod","darkgoldenrod","snow","snow","snow","snow","snow","snow","snow","snow","snow","snow","snow","snow","snow","snow","snow","snow","snow","snow","snow","snow","darkgoldenrod","darkgoldenrod","darkgoldenrod","darkgoldenrod","darkgoldenrod","darkgoldenrod","snow","snow","snow","snow","snow","snow","snow","snow","snow","snow","snow","snow","snow","snow","snow")),
                     row.names=c(NA,-392L),class=c("tbl_df","tbl",
                                                   "data.frame"))
  )
  
  all_gouzou[[type]] %>%
    mutate(X = X*LX + X0,
           Y = Y*LY+Y0) %>%
    as.data.frame()
}


# la fonction à utiliser pour mettre un gouzou dans un ggplot. Elle s'utilise comme ça :
# ggplot() %>%
#   GOUZOU_geom(5,8,10,3,'brezel')

GOUZOU_geom <- function(ggplot_object=ggplot(), X0=0, Y0=0, LX=1, LY=1, type='basique', linewidth = 3){
  
  tab_gouzou <- GOUZOU_tab(X0, Y0, LX, LY, type)
  
  # col=unique(tab_gouzou$couleur)[2]
  for(col in unique(tab_gouzou$couleur))
    ggplot_object <- ggplot_object +
      geom_polygon(data = filter(tab_gouzou, couleur == col), 
                   aes(X, Y, group = id), 
                   colour = "black", 
                   fill = col,
                   linewidth = linewidth)
  
  ggplot_object
  
}





# affiche tous les qouzous dispo avec le "type" pour les appeler
Gouzou_showoff <- function(){
  
  ggplot_object <- ggplot() +
    theme_void()
  
  all_type <- c('basique', 'fleur', 'nuage', 'brezel')
  
  i=3
  for(i in 1:length(all_type)){
    
    type_i <- all_type[i]
    # coord_Y <- floor(i/4)
    # coord_X <- i - coord_Y*3
    
    ggplot_object <- ggplot_object %>%
      GOUZOU_geom(i,1,1,0.8,type_i, 2.5) +
      annotate(geom='text', x=i+0.5, y=0.9, label = type_i, size = 7)
  }
  
  ggplot_object
  
}


Gouzou_showoff()






